import{a as j}from"./chunk-SHUQ4BQF.js";import{a as B}from"./chunk-BSIPSJGH.js";import{$ as A,A as k,B as y,Ba as R,C as l,Ea as U,G as b,H as V,Ja as q,Ka as M,L as h,P as p,Q as r,R as n,S as g,V as v,W as c,X as f,Y as H,Z as P,_ as T,a as C,b as I,ca as o,da as _,ea as x,fa as O,la as z,ma as w,oa as S,ra as N,t as d,u,xa as F,ya as L}from"./chunk-QWBLN4CG.js";var D=["carrinhoOffcanvas"],Q=()=>["/checkout"];function J(s,i){s&1&&(r(0,"li",10)(1,"a",41),o(2,"Cadastro"),n()())}function Y(s,i){s&1&&(r(0,"li",10)(1,"a",42),o(2,"Login"),n()())}function G(s,i){if(s&1&&(r(0,"div",48)(1,"div",49),o(2),n(),r(3,"div",50),o(4),n()()),s&2){let e=i.ngIf;l(2),_((e==null?null:e.nome)||"Usu\xE1rio"),l(2),_(e==null?null:e.email)}}function W(s,i){if(s&1){let e=v();r(0,"a",45),c("click",function(){d(e);let a=f(2);return u(a.irParaAdmin())}),o(1,"\xC1rea Admin"),n()}}function X(s,i){if(s&1){let e=v();r(0,"div",43),h(1,G,5,2,"div",44),r(2,"a",45),c("click",function(){d(e);let a=f();return u(a.verPedidos())}),o(3,"Ver pedidos"),n(),h(4,W,2,0,"a",46),r(5,"button",47),c("click",function(){d(e);let a=f();return u(a.finalizarSessao())}),o(6,"Finalizar sess\xE3o"),n()()}if(s&2){let e=f();l(),p("ngIf",e.userApi),l(3),p("ngIf",(e.userApi==null?null:e.userApi.tipo)==="adm")}}function K(s,i){if(s&1){let e=v();r(0,"div",51)(1,"div",52)(2,"img",53),c("error",function(a){d(e);let m=f();return u(m.onImgError(a))}),n(),r(3,"div",54)(4,"h5",55),o(5),n(),r(6,"p",56),o(7),w(8,"number"),n(),r(9,"button",57),c("click",function(){let a=d(e).$implicit,m=f();return u(m.adicionarAoCarrinho(a.id))}),g(10,"i",58),o(11," Adicionar "),n()()()()}if(s&2){let e=i.$implicit;l(2),p("src",e.img,k)("alt",e.nome),l(3),_(e.nome),l(2),x("R$ ",S(8,4,e.preco,"1.2-2"))}}function Z(s,i){if(s&1){let e=v();r(0,"li",61)(1,"div")(2,"strong"),o(3),n(),g(4,"br"),r(5,"small"),o(6),w(7,"number"),n()(),r(8,"div",62)(9,"button",63),c("click",function(){let a=d(e).$implicit,m=f(2);return u(m.alterarQuantidade(a.id,-1))}),o(10,"\u2212"),n(),r(11,"span"),o(12),n(),r(13,"button",63),c("click",function(){let a=d(e).$implicit,m=f(2);return u(m.alterarQuantidade(a.id,1))}),o(14,"+"),n(),r(15,"button",64),c("click",function(){let a=d(e).$implicit,m=f(2);return u(m.removerItem(a.id))}),g(16,"i",65),n()()()}if(s&2){let e=i.$implicit;l(3),_(e.nome),l(3),O("R$ ",S(7,4,e.preco*e.qtd,"1.2-2")," (",e.qtd,"x)"),l(6),_(e.qtd)}}function ee(s,i){if(s&1&&(r(0,"ul",59),h(1,Z,17,7,"li",60),n()),s&2){let e=f();l(),p("ngForOf",e.carrinho)}}function te(s,i){s&1&&(r(0,"p"),o(1,"Seu carrinho est\xE1 vazio."),n())}var $=class s{constructor(i,e,t){this.router=i;this.produtoService=e;this.usuarioService=t}carrinhoOffcanvasRef;produtos=[];carrinho=[];offcanvas=null;showUserMenu=!1;userApi=null;currentYear=new Date().getFullYear();ngOnInit(){this.produtoService.listar().subscribe({next:e=>{this.produtos=(e||[]).map(t=>this.normalizeProduto(t)),localStorage.setItem("produtos",JSON.stringify(this.produtos))},error:()=>{let e=localStorage.getItem("produtos");if(e){let t=JSON.parse(e);this.produtos=t.map(a=>this.normalizeProduto(a))}else this.produtos=[{id:1,nome:"Carolina Herrera Bad Boy",preco:619.9,img:"images/badboy.png"},{id:2,nome:"Invictus Victory",preco:760,img:"images/invictus.png"},{id:3,nome:"Phantom",preco:400,img:"images/phantom.png"},{id:4,nome:"Granado Gard\xEAnia",preco:599.99,img:"images/floral.png"},{id:5,nome:"Essencial \xDAnico",preco:899.9,img:"images/amadeirado.png"},{id:6,nome:"Citrus Amber",preco:699.9,img:"images/citrico.png"},{id:7,nome:"Xerjoff Erba Pura",preco:2009.9,img:"images/luxo.png"},{id:8,nome:"Stronger With You",preco:599.9,img:"images/doce.png"},{id:9,nome:"Nautica Voyage",preco:249.9,img:"images/nautica.png"},{id:10,nome:"Versace Eros",preco:399.9,img:"images/eros.png"},{id:11,nome:"Bleu de Chanel",preco:699.9,img:"images/bleu.jpg"},{id:12,nome:"212 VIP Black",preco:349.9,img:"images/212vip.png"}],localStorage.setItem("produtos",JSON.stringify(this.produtos))}}),this.carrinho=this.getCarrinho(),this.atualizarTotalLocalStorage();let i=localStorage.getItem("user");if(i)try{let e=JSON.parse(i);e?.email&&this.usuarioService.buscarPorEmail(e.email.toLowerCase()).subscribe({next:t=>{this.userApi=t},error:()=>{this.userApi=null}})}catch{this.userApi=null}}ngAfterViewInit(){this.carrinhoOffcanvasRef?.nativeElement&&typeof bootstrap<"u"&&bootstrap?.Offcanvas&&(this.offcanvas=new bootstrap.Offcanvas(this.carrinhoOffcanvasRef.nativeElement))}onDocClick(){this.showUserMenu=!1}onAvatarClick(i){i.stopPropagation(),this.showUserMenu=!this.showUserMenu}verPedidos(){this.showUserMenu=!1,this.router.navigate(["/pedidos"])}irParaAdmin(){this.showUserMenu=!1,this.router.navigate(["/admin"])}finalizarSessao(){localStorage.removeItem("user"),this.showUserMenu=!1,this.router.navigate(["/login"])}normalizeProduto(i){let e=this.normalizeImgPath(i.img);return I(C({},i),{img:e})}normalizeImgPath(i){if(!i)return"images/badboy.png";let e=i.replace(/^\/+/,"");return e=e.replace(/^src\/assets\//,"assets/"),e=e.replace(/^assets\/images\//,"images/"),e=e.replace(/^public\//,""),e=e.replace(/\.PNG$/i,".png"),e}getCarrinho(){try{let i=localStorage.getItem("carrinho");return i?JSON.parse(i).map(t=>({id:t.id,nome:t.nome,preco:Number(t.preco),img:this.normalizeImgPath(t.img),qtd:Number(t.qtd??1)})):[]}catch{return[]}}salvarCarrinho(){localStorage.setItem("carrinho",JSON.stringify(this.carrinho)),this.atualizarTotalLocalStorage()}adicionarAoCarrinho(i){let e=this.carrinho.find(t=>t.id===i);if(e)e.qtd+=1;else{let t=this.produtos.find(a=>a.id===i);t&&this.carrinho.push(I(C({},t),{qtd:1}))}this.salvarCarrinho(),this.abrirCarrinho()}alterarQuantidade(i,e){let t=this.carrinho.find(a=>a.id===i);t&&(t.qtd+=e,t.qtd<=0&&(this.carrinho=this.carrinho.filter(a=>a.id!==i)),this.salvarCarrinho())}removerItem(i){this.carrinho=this.carrinho.filter(e=>e.id!==i),this.salvarCarrinho()}get totalCarrinho(){return this.carrinho.reduce((i,e)=>i+Number(e.preco)*Number(e.qtd),0)}abrirCarrinho(){this.showUserMenu=!1,this.offcanvas?.show&&this.offcanvas.show()}fecharCarrinho(){this.offcanvas?.hide&&this.offcanvas.hide()}finalizarCompra(){if(this.carrinho.length===0){alert("Seu carrinho est\xE1 vazio!");return}this.fecharCarrinho(),this.router.navigate(["/checkout"])}atualizarTotalLocalStorage(){localStorage.setItem("total",this.totalCarrinho.toFixed(2))}onImgError(i){let e=i.target;e&&(e.onerror=null,e.src="images/badboy.png")}static \u0275fac=function(e){return new(e||s)(b(q),b(j),b(B))};static \u0275cmp=V({type:s,selectors:[["app-home"]],viewQuery:function(e,t){if(e&1&&H(D,5),e&2){let a;P(a=T())&&(t.carrinhoOffcanvasRef=a.first)}},hostBindings:function(e,t){e&1&&c("click",function(){return t.onDocClick()},y)},decls:61,vars:13,consts:[["carrinhoOffcanvas",""],["vazio",""],[1,"navbar","navbar-expand-lg","header","navbar-light"],[1,"container"],["routerLink","/",1,"navbar-brand"],["src","images/logo.png","alt","Logo",1,"logo"],["type","button","data-bs-toggle","collapse","data-bs-target","#menu","aria-label","Abrir menu",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","menu",1,"collapse","navbar-collapse","justify-content-center"],[1,"navbar-nav","gap-3"],[1,"nav-item"],["href","#produtos",1,"nav-link"],["class","nav-item",4,"ngIf"],[1,"d-flex","align-items-center","gap-2","position-relative",3,"click"],["type","button",1,"avatar-btn","me-1",3,"click"],["src","images/avatar-placeholder.png","alt","Avatar",1,"avatar"],["class","user-dropdown",4,"ngIf"],[1,"btn","btn-outline-primary","ms-2",3,"click"],[1,"fas","fa-shopping-cart","me-1"],[1,"hero"],[1,"container","text-center"],["href","#produtos","aria-label","Ir para a se\xE7\xE3o Nossos Produtos",1,"btn","btn-primary"],["id","produtos",1,"py-5","bg-light"],[1,"text-center","mb-5","fw-bold"],[1,"row","g-4"],["class","col-md-4 col-lg-3",4,"ngFor","ngForOf"],["tabindex","-1","id","carrinho","aria-labelledby","carrinhoLabel",1,"offcanvas","offcanvas-end"],[1,"offcanvas-header"],["id","carrinhoLabel"],["type","button","aria-label","Fechar",1,"btn-close","text-reset",3,"click"],[1,"offcanvas-body"],["class","list-group mb-3",4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-primary","w-100","mt-3",3,"click","routerLink"],[1,"footer","text-white","py-4","mt-5"],[1,"container","d-flex","justify-content-between","align-items-center"],[1,"social"],["href","https://www.instagram.com/matheusoliver___/"],[1,"fab","fa-instagram"],["href","https://www.facebook.com/mirrorfashion"],[1,"fab","fa-facebook"],["routerLink","/cadastro",1,"nav-link"],["routerLink","/login",1,"nav-link"],[1,"user-dropdown"],["class","user-head",4,"ngIf"],[1,"dropdown-item",3,"click"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item","text-danger",3,"click"],[1,"user-head"],[1,"user-name"],[1,"user-email"],[1,"col-md-4","col-lg-3"],[1,"card","h-100","text-center","shadow-sm"],["loading","lazy",1,"card-img-top",3,"error","src","alt"],[1,"card-body"],[1,"card-title","fw-bold"],[1,"text-muted","mb-3"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-cart-plus","me-1"],[1,"list-group","mb-3"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"d-flex","align-items-center","gap-2"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"]],template:function(e,t){if(e&1){let a=v();r(0,"nav",2)(1,"div",3)(2,"a",4),g(3,"img",5),n(),r(4,"button",6),g(5,"span",7),n(),r(6,"div",8)(7,"ul",9)(8,"li",10)(9,"a",11),o(10,"Produtos"),n()(),h(11,J,3,0,"li",12)(12,Y,3,0,"li",12),n()(),r(13,"div",13),c("click",function(E){return d(a),u(E.stopPropagation())}),r(14,"button",14),c("click",function(E){return d(a),u(t.onAvatarClick(E))}),g(15,"img",15),n(),h(16,X,7,2,"div",16),r(17,"button",17),c("click",function(){return d(a),u(t.abrirCarrinho())}),g(18,"i",18),o(19," Carrinho "),n()()()(),r(20,"section",19)(21,"div",20)(22,"h1"),o(23,"Perfumes que Encantam"),n(),r(24,"p"),o(25,"Descubra fragr\xE2ncias que despertam mem\xF3rias e emo\xE7\xF5es"),n(),r(26,"a",21),o(27,"Explorar Cole\xE7\xE3o"),n()()(),r(28,"main",22)(29,"div",3)(30,"h2",23),o(31,"Nossos Produtos"),n(),r(32,"div",24),h(33,K,12,7,"div",25),n()()(),r(34,"div",26,0)(36,"div",27)(37,"h5",28),o(38,"Seu Carrinho"),n(),r(39,"button",29),c("click",function(){return d(a),u(t.fecharCarrinho())}),n()(),r(40,"div",30),h(41,ee,2,1,"ul",31)(42,te,2,0,"ng-template",null,1,N),r(44,"div",32)(45,"strong"),o(46,"Total:"),n(),r(47,"span"),o(48),w(49,"number"),n()(),r(50,"a",33),c("click",function(){return d(a),u(t.fecharCarrinho())}),o(51," Finalizar Compra "),n()()(),r(52,"footer",34)(53,"div",35)(54,"span"),o(55),n(),r(56,"div",36)(57,"a",37),g(58,"i",38),n(),r(59,"a",39),g(60,"i",40),n()()()()}if(e&2){let a=A(43);l(11),p("ngIf",!t.userApi),l(),p("ngIf",!t.userApi),l(4),p("ngIf",t.showUserMenu),l(17),p("ngForOf",t.produtos),l(8),p("ngIf",t.carrinho.length>0)("ngIfElse",a),l(7),x("R$ ",S(49,9,t.totalCarrinho,"1.2-2")),l(2),p("routerLink",z(12,Q)),l(5),x("\xA9 ",t.currentYear," Pura Ess\xEAncia - Todos os direitos reservados")}},dependencies:[U,F,L,M,R],encapsulation:2})};export{$ as Home};
