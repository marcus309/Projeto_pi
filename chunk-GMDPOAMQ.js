import{Ba as _,C as s,Ea as w,G as v,H as S,Ja as M,L as C,P as h,Q as i,R as n,S as a,W as P,X as E,ca as r,ea as f,ga as y,ma as u,oa as g,xa as I,ya as O}from"./chunk-QWBLN4CG.js";function z(m,e){if(m&1&&(i(0,"li"),r(1),u(2,"number"),n()),m&2){let o=e.$implicit,t=E();s(),y(" ",o.nome," \u2014 ",o.qtd,"x \u2022 R$ ",g(2,3,t.calcItemTotal(o),"1.2-2")," ")}}function $(m,e){m&1&&(i(0,"li"),r(1,"Seu carrinho est\xE1 vazio."),n())}var q=class m{constructor(e){this.router=e}carrinho=[];frete=0;subtotal=0;totalFinal=0;ngOnInit(){this.carrinho=this.getCarrinho(),this.frete=this.getFretePadrao(),this.subtotal=this.calcSubtotal(this.carrinho),this.totalFinal=this.subtotal+this.frete}calcItemTotal(e){let o=Number(e.preco??0),t=Number(e.qtd??1);return o*t}onSubmit(e){e.preventDefault(),this.finalizarCompra()}finalizarCompra(){let e=this.getUsuarioLogado();if(!e?.email){alert("Fa\xE7a login para finalizar a compra."),this.router.navigate(["/login"]);return}if(this.carrinho.length===0){alert("Seu carrinho est\xE1 vazio.");return}let o=this.getCatalogo(),t=this.carrinho.map(d=>{let p=o.find(F=>String(F.id)===String(d.id));return{produtoId:d.id,nome:d.nome||p?.nome||"Produto",img:d.img||p?.img||"assets/images/placeholder.png",preco:Number(d.preco??p?.preco??0),qtd:Number(d.qtd??1)}}),c=t.reduce((d,p)=>d+p.preco*p.qtd,0),l=this.frete,k=c+l,b=new Date,x=this.gerarNumeroPedido(b),N={id:`p-${x}`,numero:x,clienteNome:e.nome||"Cliente",clienteEmail:e.email,criadoEm:b.toISOString(),status:"processando",itens:t,subtotal:c,frete:l,total:k};this.salvarPedidoLocal(N),localStorage.removeItem("carrinho"),localStorage.setItem("total","0.00"),this.router.navigate(["/pedidos"])}salvarPedidoLocal(e){try{let o=localStorage.getItem("pedidos"),t=o?JSON.parse(o):[];t.push(e),localStorage.setItem("pedidos",JSON.stringify(t))}catch{localStorage.setItem("pedidos",JSON.stringify([e]))}}gerarNumeroPedido(e){let o=e.getFullYear().toString().slice(-2),t=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0"),l=e.getTime().toString().slice(-4);return`${o}${t}${c}${l}`}getUsuarioLogado(){try{let e=localStorage.getItem("user");return e?JSON.parse(e):null}catch{return null}}getCarrinho(){try{let e=localStorage.getItem("carrinho");return e?JSON.parse(e).map(t=>({id:t.id,nome:t.nome,preco:t.preco,img:t.img,qtd:t.qtd??1})):[]}catch{return[]}}getFretePadrao(){let e=localStorage.getItem("fretePadrao"),o=e?Number(e):0;return Number.isFinite(o)?o:0}getCatalogo(){try{let e=localStorage.getItem("produtos");return e?JSON.parse(e):[]}catch{return[]}}calcSubtotal(e){return e.reduce((o,t)=>{let c=Number(t.preco??0),l=Number(t.qtd??1);return o+c*l},0)}static \u0275fac=function(o){return new(o||m)(v(M))};static \u0275cmp=S({type:m,selectors:[["app-checkout"]],decls:69,vars:14,consts:[[1,"checkout-root"],["src","/public/images/logo.png","alt","Logo",1,"logo"],["role","main","aria-label","\xC1rea de checkout",1,"quadrado"],["aria-label","Resumo do pedido",1,"left-side"],["id","lista-carrinho"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"product-card"],[1,"summary"],[2,"margin-top","8px"],["id","total-com-frete"],[1,"note"],["aria-label","Formul\xE1rio de pagamento",1,"quadrado2"],["id","checkoutForm","autocomplete","on","novalidate","",3,"submit"],["for","nome"],["id","nome","name","nome","type","text","placeholder","Seu nome","required",""],["for","email"],["id","email","name","email","type","email","placeholder","seu@email.com","required",""],["for","endereco"],["id","endereco","name","endereco","type","text","placeholder","Rua, n\xFAmero, bairro","required",""],[1,"two-cols",2,"margin-top","6px"],[1,"small"],["for","cep"],["id","cep","name","cep","type","text","placeholder","00000-000","required",""],["for","cidade"],["id","cidade","name","cidade","type","text","placeholder","S\xE3o Paulo","required",""],[1,"linha"],["for","cartao"],["id","cartao","name","cartao","type","text","placeholder","0000 0000 0000 0000","inputmode","numeric","required",""],[1,"two-cols"],["for","validade"],["id","validade","name","validade","type","text","placeholder","MM/AA","required",""],["for","cvv"],["id","cvv","name","cvv","type","password","placeholder","123","required",""],["for","cpf",2,"margin-top","6px"],["id","cpf","name","cpf","type","text","placeholder","000.000.000-00","required",""],[2,"margin-top","14px"],["type","submit","id","pagar-btn"],["role","status","aria-live","polite",1,"note"]],template:function(o,t){o&1&&(i(0,"div",0),a(1,"img",1),i(2,"div",2)(3,"div",3)(4,"ul",4),C(5,z,3,6,"li",5)(6,$,2,0,"li",6),n(),i(7,"div",7)(8,"div",8)(9,"div"),r(10,"Frete: "),i(11,"strong"),r(12),u(13,"number"),n()(),i(14,"div",9),r(15,"Total: "),i(16,"strong",10),r(17),u(18,"number"),n()()()(),i(19,"div",7)(20,"div",8)(21,"div"),r(22,"Entrega prevista"),n(),i(23,"div",11),r(24,"Envio em 2-4 dias \xFAteis"),n()()()(),i(25,"div",12)(26,"h1"),r(27,"Finalizar Compra"),n(),i(28,"form",13),P("submit",function(l){return t.onSubmit(l)}),i(29,"label",14),r(30,"Nome completo"),n(),a(31,"input",15),i(32,"label",16),r(33,"E-mail"),n(),a(34,"input",17),i(35,"label",18),r(36,"Endere\xE7o"),n(),a(37,"input",19),i(38,"div",20)(39,"div",21)(40,"label",22),r(41,"CEP"),n(),a(42,"input",23),n(),i(43,"div",21)(44,"label",24),r(45,"Cidade"),n(),a(46,"input",25),n()(),a(47,"hr",26),i(48,"label",27),r(49,"N\xFAmero do cart\xE3o"),n(),a(50,"input",28),i(51,"div",29)(52,"div",21)(53,"label",30),r(54,"Validade"),n(),a(55,"input",31),n(),i(56,"div",21)(57,"label",32),r(58,"CVV"),n(),a(59,"input",33),n()(),i(60,"label",34),r(61,"CPF"),n(),a(62,"input",35),i(63,"div",36)(64,"button",37),r(65),u(66,"number"),n()(),i(67,"div",38),r(68," Pagamento 100% seguro. Ao confirmar, voc\xEA ser\xE1 redirecionado para a finaliza\xE7\xE3o. "),n()()()()()),o&2&&(s(5),h("ngForOf",t.carrinho),s(),h("ngIf",t.carrinho.length===0),s(6),f("R$ ",g(13,5,t.frete,"1.2-2")),s(5),f("R$ ",g(18,8,t.totalFinal,"1.2-2")),s(48),f(" Pagar R$ ",g(66,11,t.totalFinal,"1.2-2")," "))},dependencies:[w,I,O,_],styles:['.checkout-root[_ngcontent-%COMP%]{position:relative;min-height:100vh;display:flex;justify-content:center;align-items:center;background:linear-gradient(135deg,#fce2cf,#f9c6b1);font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.logo[_ngcontent-%COMP%]{position:absolute;top:15px;left:25px;width:180px;height:auto}.quadrado[_ngcontent-%COMP%]{width:750px;min-height:550px;background-color:#ff914d;display:flex;justify-content:flex-end;align-items:stretch;border-radius:18px;overflow:hidden;box-shadow:0 10px 25px #00000040}.left-side[_ngcontent-%COMP%]{width:290px;background:linear-gradient(45deg,#ff5e62,#ff914d);color:#fff;padding:24px;display:flex;flex-direction:column;gap:20px}.product-card[_ngcontent-%COMP%]{background:#ffffff14;padding:14px;border-radius:12px;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.summary[_ngcontent-%COMP%]{font-size:15px;line-height:1.4}.note[_ngcontent-%COMP%]{font-size:13px;color:#030303;margin-top:6px}.quadrado2[_ngcontent-%COMP%]{width:460px;background-color:#fff;padding:40px 35px;box-sizing:border-box}h1[_ngcontent-%COMP%]{margin-top:0;margin-bottom:25px;font-size:26px;color:#222;text-align:center;font-weight:600}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:14px}label[_ngcontent-%COMP%]{font-weight:600;font-size:14px;color:#444}input[type=text][_ngcontent-%COMP%], input[type=email][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #ddd;border-radius:8px;font-size:15px;transition:.2s}input[_ngcontent-%COMP%]:focus{border-color:#f4a261;outline:none;box-shadow:0 0 4px #f4a26180}button[_ngcontent-%COMP%]{padding:14px;border:none;border-radius:10px;background:linear-gradient(45deg,#ff914d,#ff5e62);color:#fff;font-weight:700;font-size:16px;cursor:pointer;transition:.3s;position:relative;overflow:hidden}button[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:-75px;width:50px;height:100%;background:#fff6;transform:skew(-20deg);transition:.5s}button[_ngcontent-%COMP%]:hover:after{left:125%}button[_ngcontent-%COMP%]:hover{background:linear-gradient(45deg,#ff5e62,#ff914d)}.two-cols[_ngcontent-%COMP%]{display:flex;gap:12px}.small[_ngcontent-%COMP%]{flex:1}.linha[_ngcontent-%COMP%]{margin:12px 0;border:none;border-top:1px solid #eee}@media (max-width: 780px){.quadrado[_ngcontent-%COMP%]{flex-direction:column;width:92%}.left-side[_ngcontent-%COMP%]{width:100%;flex-direction:row;overflow-x:auto}.quadrado2[_ngcontent-%COMP%]{width:100%}}']})};export{q as Checkout};
